<!doctype html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-VV5DY5JBSZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-VV5DY5JBSZ');
  </script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Penncamm</title>
  <link rel="icon" type="image/png" href="favicon96.png" id="i5zs8q" />
  <meta name="description" content="Penncamm - Dont just capture content, capture memories">
  <link rel="stylesheet" href="index.css">
</head>
<body class="dark">
  <header id="siteHeader" class="site-header">
    <div class="left">Penncamm</div>
    <nav id="topNav" class="nav">
      <a href="#home" class="nav-link active">Home</a>
      <a href="#samples" class="nav-link">Samples</a>
      <a href="#features" class="nav-link">Features</a>
      <a href="#about" class="nav-link">About</a>
      <a href="#buy" class="nav-link">Buy / Estimate</a>
      <a href="#legal" class="nav-link">Legal</a>
    </nav>
    <div class="right">
      <img src="favicon96.png" class="logo" alt="Penncamm logo">
      <a class="webring-btn" href="https://www.pennbrenn.com" target="_blank" rel="noopener">Pennbrenn</a>
    </div>
  </header>

  <main id="main">
    <!-- HERO / HOME (full screen) -->
    <section id="home" class="panel hero">
      <div class="glass">
        <h1 class="title">Penncamm</h1>
        <img src="penncammcam.png" alt="Penncamm camera" class="hero-camera">
        <p class="lead">Don't just capture content, capture memories.</p>
      </div>
    </section>

    <!-- SAMPLES -->
    <section id="samples" class="panel samples">
      <div class="glass">
        <h2>Sample Photos</h2>
        <p class="sub">Each image shows results from a different lens.</p>
        <div class="sample-grid">
          <figure><img src="sam.png" alt="standard sample"><figcaption>Standard</figcaption></figure>
          <figure><img src="sam.png" alt="fisheye sample"><figcaption>Fisheye</figcaption></figure>
          <figure><img src="sam.png" alt="macro sample"><figcaption>Macro</figcaption></figure>
          <figure><img src="sam.png" alt="zoom sample"><figcaption>Zoom</figcaption></figure>
        </div>
      </div>
    </section>

    <!-- FEATURES -->
    <section id="features" class="panel features">
      <div class="glass">
        <h2>Features</h2>
        <div class="feature-grid">
          <article>
            <h3>Build & Durability</h3>
            <p>A stainless steel or reinforced plastic frame ensures durability in every moment.</p>
          </article>
          <article>
            <h3>Display</h3>
            <p>High-definition display shows your captures as they were meant to be seen.</p>
          </article>
          <article>
            <h3>Ergonomics</h3>
            <p>Textured, non-slip leather or foam grip for secure, comfortable handling.</p>
          </article>
          <article>
            <h3>Repairability</h3>
            <p>Lifetime warranty for repairs — designed to be serviceable.</p>
          </article>
          <article>
            <h3>Technology</h3>
            <p>8MP sensor, 1080p video, simple interface, and a strong flash with auto exposure.</p>
          </article>
          <article>
            <h3>Battery</h3>
            <p>Up to 2000mAh battery for extended shooting time.</p>
          </article>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="about" class="panel about">
      <div class="glass">
        <h2>About</h2>
        <p id="aboutText">Basic about me (I'll edit later).</p>
        <a class="learn-more" href="https://www.pennbrenn.com" target="_blank" rel="noopener">Learn more at pennbrenn.com</a>
      </div>
    </section>

    <!-- BUY / ESTIMATE -->
    <section id="buy" class="panel buy">
      <div class="glass">
        <h2>Estimate Generator</h2>
        <p class="note">We quote each product individually. The generator produces a ready-to-copy email and price estimate. Lead time: up to 1 month.</p>

        <div class="estimate-grid">
          <div class="options-column">
            <form id="estimateForm">
              <div class="input-row">
                <label for="custName">Your name</label>
                <input id="custName" type="text" placeholder="Full name">
              </div>
              <div class="input-row">
                <label for="custEmail">Your email</label>
                <input id="custEmail" type="email" placeholder="email@example.com">
              </div>
              <div class="input-row">
                <label for="custPhone">Phone (optional)</label>
                <input id="custPhone" type="tel" placeholder="+1 555 555 5555">
              </div>

              <!-- Dynamic options will go here -->
              <div id="optionsContainer" class="options-container"></div>

              <div class="fees">
                <label><input type="checkbox" id="includeParts" checked> Include parts ($15)</label>
                <label><input type="checkbox" id="includeLabor" checked> Include labor ($40)</label>
              </div>

              <div class="summary">
                <div>Subtotal: <span id="subtotal">$0.00</span></div>
                <div>Lead time: <strong>Up to 1 month</strong></div>
              </div>

              <div class="btn-row">
                <button type="button" id="generateBtn">Generate Email + Preview</button>
                <button type="button" id="copyBtn">Copy Email to Clipboard</button>
                <button type="button" id="mailtoBtn">Open Mail App</button>
              </div>
            </form>
          </div>

          <div class="preview-column">
            <h3>Email Preview (editable)</h3>
            <div id="emailPreview" contenteditable="true" class="email-preview"></div>
            <p class="help">You can edit the email text in the preview before copying/sending.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- LEGAL -->
    <section id="legal" class="panel legal">
      <div class="glass">
        <h2>Legal</h2>
        <p>All legal terms and warranty details are available on the separate page.</p>
        <a class="legal-link" href="./legal.html" target="_blank" rel="noopener">Open legal page</a>
      </div>
    </section>

    <footer class="site-footer">
      <small>© Penncamm — Don't just capture content, capture memories.</small>
    </footer>
  </main>

  <script>
    /* ------------- BASIC THEME & BEHAVIOR ------------- */

    const accent = '#465e73';
    const header = document.getElementById('siteHeader');
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('section.panel');

    // IntersectionObserver to highlight nav links on scroll
    const observerOptions = { root: null, rootMargin: '0px', threshold: 0.55 };
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(e => {
        const id = e.target.id;
        const link = document.querySelector('.nav-link[href="#' + id + '"]');
        if (e.isIntersecting) {
          navLinks.forEach(l => l.classList.remove('active'));
          if (link) link.classList.add('active');
        }
      });
    }, observerOptions);

    sections.forEach(s => observer.observe(s));

    // sticky header class toggle after hero
    const hero = document.getElementById('home');
    const heroObserver = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{
        if (!e.isIntersecting) header.classList.add('scrolled');
        else header.classList.remove('scrolled');
      });
    }, {root:null, threshold: 0.01});
    heroObserver.observe(hero);

    // Smooth scroll for nav
    document.querySelectorAll('.nav-link').forEach(a=>{
      a.addEventListener('click', (ev)=>{
        ev.preventDefault();
        document.querySelector(a.getAttribute('href')).scrollIntoView({behavior:'smooth'});
      });
    });

    /* ------------- BACKGROUND FADE ANIMATION (subtle, GPU friendly) ------------- */
    // CSS handles most of the animation. We'll slightly change a CSS variable to keep it low CPU.
    let hue = 0;
    setInterval(() => {
      hue = (hue + 0.2) % 360;
      document.documentElement.style.setProperty('--bg-hue-rotate', hue + 'deg');
    }, 3000); // very slow changes to avoid lag

    /* ------------- ESTIMATE GENERATOR (loads options.json) ------------- */
    const optionsContainer = document.getElementById('optionsContainer');
    const subtotalEls = {subtotal: document.getElementById('subtotal')};
    const includeParts = document.getElementById('includeParts');
    const includeLabor = document.getElementById('includeLabor');
    const emailPreview = document.getElementById('emailPreview');

    let optionsData = null;
    let pricesSelected = [];

    function formatMoney(n){ return '$' + n.toFixed(2); }

    async function loadOptions(){
      try {
        const res = await fetch('options.json');
        optionsData = await res.json();
        renderOptions(optionsData);
        calculateSubtotal();
      } catch (err){
        optionsContainer.innerHTML = '<p class="error">Unable to load options.json — make sure it exists in the site root.</p>';
        console.error(err);
      }
    }

    function renderOptions(data){
      // For each category in options.json create appropriate inputs
      optionsContainer.innerHTML = '';
      Object.entries(data).forEach(([category, items])=>{
        const catDiv = document.createElement('fieldset');
        catDiv.className = 'option-category';
        const legend = document.createElement('legend');
        legend.textContent = category;
        catDiv.appendChild(legend);

        // If items are selectable single-select or multi-select depends on schema.
        // We'll show checkboxes for "select all" categories (lens) and selects for single choices otherwise.
        if (data._multi && data._multi.includes(category)) {
          // multiple checkbox selections
          items.forEach(opt => {
            const id = `opt_${category}_${slug(opt.name)}`;
            const label = document.createElement('label');
            label.className = 'opt-checkbox';

            const input = document.createElement('input');
            input.type = 'checkbox';
            input.dataset.price = opt.price || 0;
            input.name = category;
            input.value = opt.name;
            input.id = id;
            input.addEventListener('change', calculateSubtotal);

            const span = document.createElement('span');
            span.textContent = `${opt.name} (${formatMoney(opt.price || 0)})`;

            label.appendChild(input);
            label.appendChild(span);
            catDiv.appendChild(label);
          });
        } else {
          // single select
          const select = document.createElement('select');
          select.name = category;
          select.className = 'opt-select';
          select.addEventListener('change', calculateSubtotal);
          const empty = document.createElement('option');
          empty.value = '';
          empty.textContent = '— choose —';
          select.appendChild(empty);
          items.forEach(opt=>{
            const o = document.createElement('option');
            o.value = opt.name;
            o.dataset.price = opt.price || 0;
            o.textContent = `${opt.name} (${formatMoney(opt.price || 0)})`;
            select.appendChild(o);
          });
          catDiv.appendChild(select);
        }
        optionsContainer.appendChild(catDiv);
      });
    }

    function slug(s){ return s.replace(/\s+/g,'_').replace(/[^a-z0-9_]/gi,'').toLowerCase(); }

    function calculateSubtotal(){
      let total = 0;
      pricesSelected = [];

      // selects
      document.querySelectorAll('.opt-select').forEach(sel=>{
        const selected = sel.options[sel.selectedIndex];
        if (selected && selected.dataset && selected.dataset.price){
          const p = parseFloat(selected.dataset.price) || 0;
          total += p;
          if (selected.value) pricesSelected.push({category: sel.name, name: selected.value, price: p});
        }
      });

      // checkboxes
      document.querySelectorAll('.opt-checkbox input[type="checkbox"]').forEach(cb=>{
        if (cb.checked){
          const p = parseFloat(cb.dataset.price) || 0;
          total += p;
          pricesSelected.push({category: cb.name, name: cb.value, price: p});
        }
      });

      if (includeParts.checked) total += 15;
      if (includeLabor.checked) total += 40;

      subtotalEls.subtotal.textContent = formatMoney(total);
    }

    document.getElementById('generateBtn').addEventListener('click', generateEmail);
    document.getElementById('copyBtn').addEventListener('click', copyEmail);
    document.getElementById('mailtoBtn').addEventListener('click', openMailApp);

    function generateEmail(){
      calculateSubtotal();
      const name = document.getElementById('custName').value || '[Your name]';
      const email = document.getElementById('custEmail').value || '[Your email]';
      const phone = document.getElementById('custPhone').value || '[Phone]';

      const lines = [];
      lines.push(`To: cam@pennbrenn.com`);
      lines.push(`Subject: Penncamm Custom Quote Request`);
      lines.push('');
      lines.push(`Hello Pennbrenn / Penncamm team,`);
      lines.push('');
      lines.push(`I'd like a quote for a custom Penncamm camera. My contact details:`);
      lines.push(`Name: ${name}`);
      lines.push(`Email: ${email}`);
      lines.push(`Phone: ${phone}`);
      lines.push('');
      lines.push(`Selected options:`);
      if (pricesSelected.length === 0) {
        lines.push('- (No options selected)');
      } else {
        pricesSelected.forEach(p => {
          lines.push(`- ${p.category}: ${p.name} — ${formatMoney(p.price)}`);
        });
      }
      if (includeParts.checked) lines.push(`- Parts: $15`);
      if (includeLabor.checked) lines.push(`- Labor: $40`);
      lines.push('');
      lines.push(`Estimated total: ${subtotalEls.subtotal.textContent}`);
      lines.push('');
      lines.push(`Notes / Questions: (edit here)`);
      lines.push('');
      lines.push(`Lead time: Up to 1 month.`);
      lines.push('');
      lines.push(`Thanks,`);
      lines.push(`${name}`);
      lines.push(`${email}`);
      lines.push(`${phone}`);

      emailPreview.textContent = lines.join('\\n');
    }

    function copyEmail(){
      const text = emailPreview.textContent;
      navigator.clipboard.writeText(text).then(()=> {
        alert('Email copied to clipboard. You can paste it into your mail client.');
      }, (err) => {
        alert('Copy failed — please select and copy manually.');
      });
    }

    function openMailApp(){
      const subject = encodeURIComponent('Penncamm Custom Quote Request');
      const body = encodeURIComponent(emailPreview.textContent || 'Hello, I would like a quote...');
      // To: cam@pennbrenn.com
      const mailto = `mailto:cam@pennbrenn.com?subject=${subject}&body=${body}`;
      window.location.href = mailto;
    }

    // update subtotal when parts/labor toggled
    includeParts.addEventListener('change', calculateSubtotal);
    includeLabor.addEventListener('change', calculateSubtotal);

    // initial load
    loadOptions();

    // small helper: ensure checkboxes visually black bg with white text (also CSS ensures)
    document.documentElement.style.setProperty('--accent', '${accent}');
  </script>

</body>
</html>
