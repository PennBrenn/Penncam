<!doctype html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-VV5DY5JBSZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-VV5DY5JBSZ');
  </script>

  <meta charset="utf-8" />
  <title>Penncamm</title>
  <link rel="icon" type="image/png" href="favicon96.png" id="i5zs8q" />
  <meta name="description" content="Penncamm - Dont just capture content, capture memories">
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="index.css">
</head>
<body>
  <header class="header" role="banner" aria-label="Main header">
    <div class="brand">
      <h1>Penncamm</h1>
    </div>

    <nav class="nav" aria-label="Section navigation" id="mainNav">
      <button data-target="home" class="nav-btn active">Home</button>
      <button data-target="samples" class="nav-btn">Samples</button>
      <button data-target="features" class="nav-btn">Features</button>
      <button data-target="about" class="nav-btn">About</button>
      <button data-target="buy" class="nav-btn">Buy / Estimate</button>
      <button data-target="legal" class="nav-btn">Legal</button>
    </nav>

    <div class="header-right">
      <img src="favicon96.png" alt="Penncamm logo" class="logo" />
      <a class="btn webring-btn" href="https://www.pennbrenn.com" target="_blank" rel="noopener">Pennbrenn webring</a>
    </div>
  </header>

  <main>
    <div class="container">

      <!-- HOME -->
      <section id="home" class="section hero" aria-label="Home">
        <h2>Penncamm</h2>
        <img src="penncammcam.png" alt="Penncamm camera" id="heroImg" />
        <p>Don't just capture content, capture memories.</p>
      </section>

      <!-- SAMPLES -->
      <section id="samples" class="section" aria-label="Sample photos">
        <h3 style="color:#fafdff; font-family: 'Courier New', Courier; margin-top:0;">Sample Photos</h3>
        <div class="photos-grid" id="photosGrid">
          <img src="sam.png" alt="Standard sample">
          <img src="sam.png" alt="Fisheye sample">
          <img src="sam.png" alt="Macro sample">
          <img src="sam.png" alt="Zoom sample">
        </div>
        <p style="margin-top:12px; color:var(--para-color)">Photos taken with: standard, fisheye, macro, zoom.</p>
      </section>

      <!-- FEATURES -->
      <section id="features" class="section features" aria-label="Features">
        <h3 style="color:#fafdff; font-family: 'Courier New', Courier; margin-top:0;">Features</h3>
        <div class="feat-grid">
          <div class="feature-card">
            <h4>Build Durability</h4>
            <p>A stainless steel or reinforced plastic frame ensures durability in every moment.</p>
          </div>
          <div class="feature-card">
            <h4>Display</h4>
            <p>A high-definition display lets you see your memories as they were meant to be seen.</p>
          </div>
          <div class="feature-card">
            <h4>Ergonomics</h4>
            <p>A textured, non-slip leather or foam grip ensures secure, comfortable handling.</p>
          </div>
          <div class="feature-card">
            <h4>Repairability</h4>
            <p>With a lifetime warranty, you can be reassured that you'll have every moment.</p>
          </div>

          <div class="feature-card">
            <h4>Technology / Sensor</h4>
            <p>An 8MP sensor with 1080p video allows every moment to be captured with clear, vivid detail.</p>
          </div>
          <div class="feature-card">
            <h4>Battery</h4>
            <p>Up to a 2000mAh battery gives you extended time to get every detail without interruption.</p>
          </div>
          <div class="feature-card">
            <h4>Interface</h4>
            <p>With minimal controls, capturing memories becomes second nature.</p>
          </div>
          <div class="feature-card">
            <h4>Flash</h4>
            <p>A strong flash, combined with the camera's auto exposure, lets every moment be lit.</p>
          </div>
        </div>
      </section>

      <!-- ABOUT -->
      <section id="about" class="section about" aria-label="About">
        <h3 style="color:#fafdff; font-family: 'Courier New', Courier; margin-top:0;">About</h3>
        <p>Basic about me (I'll edit later). Penncamm makes handmade digital cameras built to last — designed and assembled with care.</p>
        <p style="margin-top:12px;"><a class="btn primary" href="https://www.pennbrenn.com" target="_blank" rel="noopener">Learn more</a></p>
      </section>

      <!-- BUY / ESTIMATE -->
      <section id="buy" class="section" aria-label="Buy / Estimate">
        <h3 style="color:#fafdff; font-family: 'Courier New', Courier; margin-top:0;">Buy / Estimate</h3>
        <div class="estimate-grid">
          <div class="options-panel" id="optionsPanel">
            <p class="multiselect-note">Options are loaded from <code>options.json</code>. Select items and build your estimate. Lens supports multiple selections.</p>

            <div id="optionsForm">
              <!-- dynamic inserts -->
            </div>

            <label for="custName">Your name</label>
            <input id="custName" type="text" placeholder="Full name" />

            <label for="custEmail">Your email</label>
            <input id="custEmail" type="text" placeholder="you@example.com" />

            <label for="custPhone">Phone (optional)</label>
            <input id="custPhone" type="text" placeholder="+1 555 555 5555" />

            <label for="extraNotes">Questions / Notes</label>
            <textarea id="extraNotes" rows="4" placeholder="e.g. preferred colors, deadlines"></textarea>

            <p style="font-size:13px; color:var(--para-color)">Lead time: <strong id="leadTime">Up to 1 month</strong></p>
          </div>

          <aside class="summary" aria-label="Estimate summary">
            <h3>Estimate</h3>
            <div id="itemsList" style="max-height:260px; overflow:auto;"></div>
            <div class="price-row"><div>Parts</div><div id="feeParts">$0.00</div></div>
            <div class="price-row"><div>Labor</div><div id="feeLabor">$0.00</div></div>
            <div class="price-row total"><div>Total</div><div id="totalPrice">$0.00</div></div>

            <h4 style="margin-top:12px; color:var(--title-color); font-family:var(--title-font);">Email Preview</h4>
            <div id="emailPreview" class="email-preview" contenteditable="true" aria-label="Editable email preview"></div>

            <div style="margin-top:10px; display:flex; gap:8px;">
              <button class="btn" id="copyEmailBtn">Copy email</button>
              <button class="btn primary" id="sendEmailBtn">Compose email</button>
            </div>
          </aside>
        </div>
      </section>

      <!-- LEGAL -->
      <section id="legal" class="section" aria-label="Legal">
        <h3 style="color:#fafdff; font-family: 'Courier New', Courier; margin-top:0;">Legal</h3>
        <p style="color:var(--para-color)">All sales are individualized and quoted. Lifetime warranty applies for manufacturing defects only. No rentals. Based in the US (California). Returns only for defects. Contact for more info.</p>
        <p><a class="btn legal-btn" href="#" onclick="alert('Open your legal modal or page here.'); return false;">View legal</a></p>
      </section>

    </div>
  </main>

  <script>
  // Inline JS: loads options.json, builds UI, computes totals, builds email.
  (function(){
    const navButtons = document.querySelectorAll('.nav-btn');
    const sections = document.querySelectorAll('main .section');
    const optionsForm = document.getElementById('optionsForm');
    const itemsList = document.getElementById('itemsList');
    const feePartsEl = document.getElementById('feeParts');
    const feeLaborEl = document.getElementById('feeLabor');
    const totalPriceEl = document.getElementById('totalPrice');
    const emailPreview = document.getElementById('emailPreview');
    const copyEmailBtn = document.getElementById('copyEmailBtn');
    const sendEmailBtn = document.getElementById('sendEmailBtn');
    const leadTimeEl = document.getElementById('leadTime');

    let optionsData = null;

    // Smooth scrolling when nav clicked
    document.querySelectorAll('.nav-btn').forEach(btn=>{
      btn.addEventListener('click', ()=> {
        document.getElementById(btn.dataset.target).scrollIntoView({behavior:'smooth', block:'center'});
      });
    });

    // IntersectionObserver to update active nav
    const observer = new IntersectionObserver(entries=>{
      entries.forEach(entry=>{
        if(entry.isIntersecting){
          const id = entry.target.id;
          navButtons.forEach(b=>{
            if(b.dataset.target === id){
              b.classList.add('active');
            } else {
              b.classList.remove('active');
            }
          });
        }
      });
    }, {threshold:0.5});

    sections.forEach(s=>observer.observe(s));

    // Load options.json
    fetch('options.json').then(r=>r.json()).then(data=>{
      optionsData = data;
      leadTimeEl.textContent = data.flat_fees.lead_time || data.flat_fees.lead_time || 'Up to 1 month';
      feePartsEl.textContent = formatCurrency(data.flat_fees.parts || 0);
      feeLaborEl.textContent = formatCurrency(data.flat_fees.labor || 0);
      buildOptionsUI(data.categories);
      computeAndRender();
    }).catch(err=>{
      optionsForm.innerHTML = '<p style="color:#fafdff">Failed to load options.json — check the file is reachable.</p>';
      console.error(err);
    });

    function buildOptionsUI(categories){
      optionsForm.innerHTML = '';
      categories.forEach(cat=>{
        const wrapper = document.createElement('div');
        wrapper.style.marginBottom = '12px';
        const label = document.createElement('label');
        label.textContent = cat.label;
        wrapper.appendChild(label);

        if(cat.type === 'multi'){
          const note = document.createElement('div');
          note.className = 'multiselect-note';
          note.textContent = 'Hold Ctrl/Cmd to select multiple, or use checkboxes below.';
          wrapper.appendChild(note);
          // render checkboxes for multi
          cat.options.forEach(opt=>{
            const id = `${cat.id}_${opt.id}`;
            const el = document.createElement('div');
            el.style.display='flex';
            el.style.justifyContent='space-between';
            el.style.alignItems='center';
            el.style.margin='6px 0';
            const left = document.createElement('label');
            left.style.flex='1';
            left.style.display='flex';
            left.style.alignItems='center';
            left.style.gap='8px';
            const cb = document.createElement('input');
            cb.type = 'checkbox';
            cb.dataset.cat = cat.id;
            cb.value = opt.id;
            cb.dataset.price = opt.price;
            cb.addEventListener('change', computeAndRender);
            left.appendChild(cb);
            const span = document.createElement('span');
            span.textContent = opt.name;
            left.appendChild(span);
            el.appendChild(left);

            const priceSpan = document.createElement('div');
            priceSpan.textContent = formatCurrency(opt.price);
            el.appendChild(priceSpan);

            wrapper.appendChild(el);
          });
        } else {
          const sel = document.createElement('select');
          sel.dataset.cat = cat.id;
          sel.addEventListener('change', computeAndRender);
          cat.options.forEach(opt=>{
            const o = document.createElement('option');
            o.value = opt.id;
            o.textContent = `${opt.name} — ${formatCurrency(opt.price)}`;
            o.dataset.price = opt.price;
            sel.appendChild(o);
          });
          wrapper.appendChild(sel);
        }
        optionsForm.appendChild(wrapper);
      });
    }

    function computeAndRender(){
      if(!optionsData) return;
      const selectedItems = [];
      let subtotal = 0;

      // find selects
      document.querySelectorAll('#optionsForm select').forEach(sel=>{
        const cat = optionsData.categories.find(c=>c.id === sel.dataset.cat);
        const opt = cat.options.find(o=>o.id === sel.value);
        if(opt){
          selectedItems.push({label:cat.label, name:opt.name, price:opt.price});
          subtotal += Number(opt.price || 0);
        }
      });

      // find checkboxes
      document.querySelectorAll('#optionsForm input[type="checkbox"]').forEach(cb=>{
        if(cb.checked){
          const cat = optionsData.categories.find(c=>c.id === cb.dataset.cat);
          const opt = (cat && cat.options.find(o=>o.id===cb.value));
          if(opt){
            selectedItems.push({label:cat.label, name:opt.name, price:opt.price});
            subtotal += Number(opt.price || 0);
          }
        }
      });

      const parts = Number(optionsData.flat_fees.parts || 0);
      const labor = Number(optionsData.flat_fees.labor || 0);
      const total = subtotal + parts + labor;

      // render list
      itemsList.innerHTML = '';
      if(selectedItems.length === 0){
        itemsList.innerHTML = '<p style="color:var(--para-color)">No options selected yet.</p>';
      } else {
        selectedItems.forEach(it=>{
          const row = document.createElement('div');
          row.className = 'price-row';
          row.style.borderBottom = '1px dashed rgba(255,255,255,0.03)';
          row.style.padding = '6px 0';
          const left = document.createElement('div');
          left.style.flex = '1';
          left.textContent = `${it.label}: ${it.name}`;
          const right = document.createElement('div');
          right.textContent = formatCurrency(it.price);
          row.appendChild(left);
          row.appendChild(right);
          itemsList.appendChild(row);
        });
      }

      feePartsEl.textContent = formatCurrency(parts);
      feeLaborEl.textContent = formatCurrency(labor);
      totalPriceEl.textContent = formatCurrency(total);

      // build default email preview content
      const name = document.getElementById('custName').value || '[Your name]';
      const email = document.getElementById('custEmail').value || '[Your email]';
      const phone = document.getElementById('custPhone').value || '[Phone if provided]';
      const notes = document.getElementById('extraNotes').value || '';

      const lines = [];
      lines.push(`Hello Pennbrenn / Penncamm team,`);
      lines.push('');
      lines.push(`I'd like a custom quote for a Penncamm camera. My details:`);
      lines.push(`Name: ${name}`);
      lines.push(`Email: ${email}`);
      lines.push(`Phone: ${phone}`);
      lines.push('');
      lines.push(`Selected options:`);
      selectedItems.forEach(it=>{
        lines.push(`- ${it.label}: ${it.name} — ${formatCurrency(it.price)}`);
      });
      lines.push('');
      lines.push(`Parts: ${formatCurrency(parts)}`);
      lines.push(`Labor: ${formatCurrency(labor)}`);
      lines.push(`Total Estimate: ${formatCurrency(total)}`);
      lines.push('');
      lines.push(`Lead time: ${optionsData.flat_fees.lead_time || 'Up to 1 month'}`);
      if(notes) {
        lines.push('');
        lines.push('Extra notes:');
        lines.push(notes);
      }
      lines.push('');
      lines.push('Thanks,');
      lines.push(name);

      emailPreview.innerText = lines.join('\n');
    }

    function formatCurrency(n){
      return '$' + Number(n).toFixed(2);
    }

    // update preview on inputs
    ['custName','custEmail','custPhone','extraNotes'].forEach(id=>{
      const el = document.getElementById(id);
      el && el.addEventListener('input', computeAndRender);
    });

    copyEmailBtn.addEventListener('click', ()=>{
      const text = emailPreview.innerText;
      navigator.clipboard && navigator.clipboard.writeText(text).then(()=>{
        copyEmailBtn.textContent = 'Copied!';
        setTimeout(()=> copyEmailBtn.textContent = 'Copy email', 1800);
      }).catch(err=>{
        alert('Copy failed. You can manually select the preview and copy.');
      });
    });

    sendEmailBtn.addEventListener('click', ()=>{
      const to = 'cam@pennbrenn.com';
      const subj = encodeURIComponent('Penncamm estimate request');
      const body = encodeURIComponent(emailPreview.innerText);
      // Open mailto with body
      window.location.href = `mailto:${to}?subject=${subj}&body=${body}`;
    });

    // initial compute periodically in case user loads fast
    setTimeout(computeAndRender, 900);

    // Allow user to click images to enlarge
    document.querySelectorAll('.photos-grid img, #heroImg').forEach(img=>{
      img.style.cursor = 'zoom-in';
      img.addEventListener('click', ()=> {
        const w = window.open('');
        const doc = w.document;
        doc.write('<title>Image preview</title>');
        doc.write('<style>body{margin:0;display:flex;align-items:center;justify-content:center;background:#000;height:100vh}img{max-width:95vw;max-height:95vh}</style>');
        doc.write(`<img src="${img.src}" alt="${img.alt}">`);
        doc.close();
      });
    });

  })();
  </script>
</body>
</html>
